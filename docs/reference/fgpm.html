<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gaussian process models for scalar and functional inputs — fgpm • funGp</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Gaussian process models for scalar and functional inputs — fgpm" />
<meta property="og:description" content="This function enables fitting of Gaussian process regression models. The inputs can be
  either scalar, functional or a combination of both types." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funGp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/djbetancourt-gh/funGp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gaussian process models for scalar and functional inputs</h1>
    
    <div class="hidden name"><code>fgpm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function enables fitting of Gaussian process regression models. The inputs can be
  either scalar, functional or a combination of both types.</p>
    </div>

    <pre class="usage"><span class='fu'>fgpm</span>(
  <span class='kw'>sIn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>sOut</span>,
  <span class='kw'>kerType</span> <span class='kw'>=</span> <span class='st'>"matern5_2"</span>,
  <span class='kw'>f_disType</span> <span class='kw'>=</span> <span class='st'>"L2_bygroup"</span>,
  <span class='kw'>f_pdims</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>f_basType</span> <span class='kw'>=</span> <span class='st'>"B-splines"</span>,
  <span class='kw'>var.hyp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ls_s.hyp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ls_f.hyp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>,
  <span class='kw'>n.starts</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>n.presample</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>par.clust</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>quietly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sIn</th>
      <td><p>an optional matrix of scalar input values to train the model. Each column must match an input
variable and each row a training point. Either scalar input coordinates (sIn), functional input
coordinates (fIn), or both must be provided.</p></td>
    </tr>
    <tr>
      <th>fIn</th>
      <td><p>an optional list of functional input values to train the model. Each element of the list must
be a matrix containing to the set of curves corresponding to one functional input. Either scalar input
coordinates (sIn), functional input coordinates (fIn), or both must be provided.</p></td>
    </tr>
    <tr>
      <th>sOut</th>
      <td><p>a vector (or 1-column matrix) containing the values of the scalar output at the specified
input points.</p></td>
    </tr>
    <tr>
      <th>kerType</th>
      <td><p>an optional character string specifying the covariance structure to be used. To be chosen
between "gauss", "matern5_2" and "matern3_2". Default is "matern5_2".</p></td>
    </tr>
    <tr>
      <th>f_disType</th>
      <td><p>an optional array of character strings specifying the distance function to be used for
each functional coordinates within the covariance function of the Gaussian process. To be chosen between
"L2_bygroup" and "L2_byindex". The L2_bygroup distance considers each courve as a whole and uses a single
length-scale parameter per functional input variable. The L2_byindex distance uses as many length-scale
parameters per functional input as discretization points it has. For instance an input discretized as
a vector of size 8 will use 8 length-scale parameters when using L2_byindex. If dimension reduction of
a functional input is requested, then L2_byindex uses as many length scale parameters as efective
dimensions are used to represent the input. A single character string can also be passed as a general
selection for all the functional inputs of the model. More details in
<a href='https://www.sciencedirect.com/science/article/abs/pii/S0951832019301693'>
the reference article</a>
and
<a href='https://drive.google.com/file/d/1MtYi-Qq-BNZpbp1SWWG4Fb35HvVqRHQM/view?usp=sharing'>
the in-depth package manual</a>. Default is "L2_bygroup".</p></td>
    </tr>
    <tr>
      <th>f_pdims</th>
      <td><p>an optional array with the projection dimension for each functional input. For each input,
the projection dimension should be an integer between 0 and its original dimension, with 0 denoting
no projection. A single character string can also be passed as a general selection for all the functional
inputs of the model. Default is 3.</p></td>
    </tr>
    <tr>
      <th>f_basType</th>
      <td><p>an optional array of character strings specifying the family of basis function to be used
in the projection of each functional input. To be chosen between "B-splines" and "PCA". A single character
string can also be passed as a general selection for all the functional inputs of the model. This argument
will be ignored for those inputs for which no projection was requested (i.e., for which f_pdims = 0).
Default is "B-splines".</p></td>
    </tr>
    <tr>
      <th>var.hyp</th>
      <td><p>an optional number indicating the value that should be used as the variance parameter of the
model. If not provided, it is estimated through likelihood maximization.</p></td>
    </tr>
    <tr>
      <th>ls_s.hyp</th>
      <td><p>an optional numeric array indicating the values that should be used as length-scale parameters
for the scalar inputs. If provided, the size of the array should match the number of scalar inputs. If not
provided, this parameters are estimated through likelihood maximization.</p></td>
    </tr>
    <tr>
      <th>ls_f.hyp</th>
      <td><p>an optional numeric array indicating the values that should be used as length-scale parameters
for the functional inputs. If provided, the size of the array should match the number of effective dimensions.
Each input using the "L2_bygroup" distance will count 1 effective dimension, and each input using the
"L2_byindex" distance will count as many effective dimensions as specified by the corresponding element of
the f_pdims argument. For instance, two functional inputs of original dimensions 10 and 22, the first one
projected onto a space of dimension 5 with "L2_byindex" distance, and the second one not projected with
"L2_byindex" distance will make up a total of 6 effective dimensions; five for the first functional input and
one for second one. If this argument is not provided, the functional length-scale parameters are estimated
through likelihood maximization.</p></td>
    </tr>
    <tr>
      <th>nugget</th>
      <td><p>an optional variance value standing for the homogeneous nugget effect. A tiny nugget might help
to overcome numerical problems related to the ill-conditioning of the covariance matrix. Default is 1e-8.</p></td>
    </tr>
    <tr>
      <th>n.starts</th>
      <td><p>an optional integer indicating the number of initial points to use for the optimization of the
hyperparameters. A parallel processing cluster can be exploited in order to speed up the evaluation of
multiple initial points. More details in the description of the argument par.clust below. Default is 1.</p></td>
    </tr>
    <tr>
      <th>n.presample</th>
      <td><p>an optional integer indicating the number of points to be tested in order to select the
n.starts intial points. The n.presampre points will be randomly sampled from the hyper-rectangle defined by: <br /> <br />
1e-10 \(\le\) <code>ls_s.hyp[i]</code> \(\le\) 2*max(<code>sMs[[i]]</code>), for i in 1 to the number of scalar inputs, <br />
1e-10 \(\le\) <code>ls_f.hyp[i]</code> \(\le\) 2*max(<code>fMs[[i]]</code>), for i in 1 to the number of functional inputs, <br /> <br />
with  sMs and fMs the lists of distance matrices for the scalar and functional inputs, respectively. The value of
n.starts will be assigned to n.presample if this last is smaller. Default is 20.</p></td>
    </tr>
    <tr>
      <th>par.clust</th>
      <td><p>an optional parallel processing cluster created with the <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code> function
of the parallel package. If not provided, multistart optimizations are done in sequence.</p></td>
    </tr>
    <tr>
      <th>quietly</th>
      <td><p>an optional boolean indicating if the calls to the hyperparameters optimizer should ommit text related to
the evolution of the optimization. Default is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='fgpm-class.html'>fgpm</a> containing the data structures representing the fitted funGp model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Betancourt, J., Bachoc, F., Klein, T., Idier, D., Pedreros, R., and Rohmer, J. (2020),
"Gaussian process metamodeling of functional-input code for coastal flood hazard assessment".
<em>Reliability Engineering &amp; System Safety</em>, <strong>198</strong>, 106870.
<a href='https://www.sciencedirect.com/science/article/abs/pii/S0951832019301693'>[RESS]</a>
<a href='https://hal.archives-ouvertes.fr/hal-01998724'>[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., Klein, T., and Gamboa, F. (2020),
Technical Report: "Ant Colony Based Model Selection for Functional-Input Gaussian Process Regression. Ref. D3.b (WP3.2)".
<em>RISCOPE project</em>.
<a href='https://hal.archives-ouvertes.fr/hal-02532713'>[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., and Klein, T. (2020),
R Package Manual: "Gaussian Process Regression for Scalar and Functional Inputs with funGp - The in-depth tour".
<em>RISCOPE project</em>.
<a href='https://drive.google.com/file/d/1MtYi-Qq-BNZpbp1SWWG4Fb35HvVqRHQM/view?usp=sharing'>[HAL]</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><strong>*</strong> <a href='plotLOO-methods.html'>plotLOO</a> for diagnostic plot of a funGp model;</p>
<p><strong>*</strong> <a href='predict-methods.html'>predict</a> for predictions based on a funGp model;</p>
<p><strong>*</strong> <a href='simulate-methods.html'>simulate</a> for simulations based on a funGp model;</p>
<p><strong>*</strong> <a href='update-methods.html'>update</a> for post-creation updates on a funGp model;</p>
<p><strong>*</strong> <a href='fgpm_factory.html'>fgpm_factory</a> for funGp heuristic model selection.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># creating funGp model using default fgpm arguments________________________________________</span>
<span class='co'># generating input data for training</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))

<span class='co'># generating output data for training</span>
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># building a scalar-input funGp model</span>
<span class='no'>ms</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># building a functional-input funGp model</span>
<span class='no'>mf</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># building a hybrid-input funGp model</span>
<span class='no'>msf</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># plotting the three models</span>
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>ms</span>)
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>mf</span>)
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>msf</span>)

<span class='co'># printing the three models</span>
<span class='no'>ms</span> <span class='co'># equivalent to show(ms)</span>
<span class='no'>mf</span> <span class='co'># equivalent to show(mf)</span>
<span class='no'>msf</span> <span class='co'># equivalent to show(msf)</span>


<span class='co'># recovering useful information from a funGp model_________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># recovering data from model slots</span>
<span class='no'>m1</span>@<span class='kw'>f_proj</span>@<span class='kw'>coefs</span> <span class='co'># list of projection coefficients for the functional inputs</span>
<span class='no'>m1</span>@<span class='kw'>f_proj</span>@<span class='kw'>basis</span> <span class='co'># list of projection basis functions for the functional inputs</span>
<span class='fu'><a href='https://rdrr.io/r/base/funprog.html'>Map</a></span>(<span class='kw'>function</span>(<span class='no'>a</span>, <span class='no'>b</span>) <span class='no'>a</span> <span class='kw'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>b</span>), <span class='no'>m1</span>@<span class='kw'>f_proj</span>@<span class='kw'>coefs</span>, <span class='no'>m1</span>@<span class='kw'>f_proj</span>@<span class='kw'>basis</span>) <span class='co'># list of projected</span>
                                                                 <span class='co'># functional inputs</span>
<span class='fu'><a href='https://rdrr.io/r/base/crossprod.html'>tcrossprod</a></span>(<span class='no'>m1</span>@<span class='kw'>preMats</span>$<span class='no'>L</span>) <span class='co'># training auto-covariance matrix</span>


<span class='co'># making predictions based on a funGp model________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># generating input data for prediction</span>
<span class='no'>n.pr</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>sIn.pr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.pr</span>)),
                                <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.pr</span>))))
<span class='no'>fIn.pr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.pr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.pr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))

<span class='co'># making predictions</span>
<span class='no'>m1.preds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='predict-methods.html'>predict</a></span>(<span class='no'>m1</span>, <span class='kw'>sIn.pr</span> <span class='kw'>=</span> <span class='no'>sIn.pr</span>, <span class='kw'>fIn.pr</span> <span class='kw'>=</span> <span class='no'>fIn.pr</span>)

<span class='co'># plotting predictions</span>
<span class='fu'><a href='plotPreds-methods.html'>plotPreds</a></span>(<span class='no'>m1</span>, <span class='kw'>preds</span> <span class='kw'>=</span> <span class='no'>m1.preds</span>)


<span class='co'># simulating from a funGp model____________________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># generating input data for simulation</span>
<span class='no'>n.sm</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>sIn.sm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.sm</span>)),
                                <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.sm</span>))))
<span class='no'>fIn.sm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.sm</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.sm</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))

<span class='co'># making simulations</span>
<span class='no'>m1.sims</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simulate-methods.html'>simulate</a></span>(<span class='no'>m1</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>sIn.sm</span> <span class='kw'>=</span> <span class='no'>sIn.sm</span>, <span class='kw'>fIn.sm</span> <span class='kw'>=</span> <span class='no'>fIn.sm</span>)

<span class='co'># plotting simulations</span>
<span class='fu'><a href='plotSims-methods.html'>plotSims</a></span>(<span class='no'>m1</span>, <span class='no'>m1.sims</span>)


<span class='co'># creating funGp model using custom fgpm arguments_________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># original dimensions</span>
<span class='co'># f1: 10</span>
<span class='co'># f2: 22</span>

<span class='co'># building a the model with the following structure</span>
<span class='co'>#    - Kernel: Gaussian</span>
<span class='co'>#    - f1: L2_byindex distance, no projection -&gt; 10 length-scale parameters</span>
<span class='co'>#    - f2: L2_bygroup distance, B-spline basis of dimension 5 -&gt; 1 length-scale parameter</span>
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>,
           <span class='kw'>kerType</span> <span class='kw'>=</span> <span class='st'>"gauss"</span>, <span class='kw'>f_disType</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L2_byindex"</span>, <span class='st'>"L2_bygroup"</span>),
           <span class='kw'>f_pdims</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>5</span>), <span class='kw'>f_basType</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>, <span class='st'>"B-splines"</span>))

<span class='co'># plotting the model</span>
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>m1</span>)

<span class='co'># printing the model</span>
<span class='no'>m1</span> <span class='co'># equivalent to show(m1)</span>

<span class='co'># \donttest{</span>
<span class='co'># multistart and parallelization in fgpm___________________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>243</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># calling fgpm with multistart in parallel</span>
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>2</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>n.starts</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>par.clust</span> <span class='kw'>=</span> <span class='no'>cl</span>) <span class='co'># (~14 seconds)</span>
<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jose Betancourt, François Bachoc, Thierry Klein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


