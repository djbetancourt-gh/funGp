<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Easy update of funGp funGp Gaussian process models — update • funGp</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Easy update of funGp funGp Gaussian process models — update" />

<meta property="og:description" content="This method enables the update of data or hyperparameters of a funGp Gaussian process model.
  It corresponds to an object of the class fgpm. The method allows addition, subtraction
  and substitution of data points, as well as substitution and re-estimation of hyperparameters." />

<meta property="og:image" content="/logo.png" />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funGp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/djbetancourt-gh/funGp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Easy update of funGp funGp Gaussian process models</h1>
    
    <div class="hidden name"><code>update-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This method enables the update of data or hyperparameters of a funGp Gaussian process model.
  It corresponds to an object of the class <a href='fgpm-class.html'>fgpm</a>. The method allows addition, subtraction
  and substitution of data points, as well as substitution and re-estimation of hyperparameters.</p>
    
    </div>

    <pre class="usage"><span class='fu'>update</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for fgpm</span>
<span class='fu'>update</span>(
  <span class='no'>object</span>,
  <span class='kw'>sIn.nw</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fIn.nw</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sOut.nw</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sIn.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fIn.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sOut.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ind.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ind.dl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>var.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ls_s.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ls_f.sb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>var.re</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ls_s.re</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>ls_f.re</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object of class <a href='fgpm-class.html'>fgpm</a> corresponding to the funGp model to update.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used.</p></td>
    </tr>
    <tr>
      <th>sIn.nw</th>
      <td><p>an optional matrix of scalar input values to be added to the model. Each column must match
an input variable and each row a scalar coordinate.</p></td>
    </tr>
    <tr>
      <th>fIn.nw</th>
      <td><p>an optional list of functional input values to be added to the model. Each element of the
list must be a matrix containing to the set of curves corresponding to one functional input.</p></td>
    </tr>
    <tr>
      <th>sOut.nw</th>
      <td><p>an optional vector (or 1-column matrix) containing the values of the scalar output at the
new input points.</p></td>
    </tr>
    <tr>
      <th>sIn.sb</th>
      <td><p>an optional matrix of scalar input values to be used as substitutes of other scalar input
values already stored in the model. Each column must match an input variable and each row a coordinate.</p></td>
    </tr>
    <tr>
      <th>fIn.sb</th>
      <td><p>an optional list of functional input values to be added to the model. Each element of the
list must be a matrix containing to the set of curves corresponding to one functional input.</p></td>
    </tr>
    <tr>
      <th>sOut.sb</th>
      <td><p>an optional vector (or 1-column matrix) containing the values of the scalar output at the
substituting input points.</p></td>
    </tr>
    <tr>
      <th>ind.sb</th>
      <td><p>an optional numeric array indicating the indices of the input and output points stored in
the model, that should be replaced by the values specified through sIn.sb, fIn.sb and/or, sOut.sb.</p></td>
    </tr>
    <tr>
      <th>ind.dl</th>
      <td><p>an optional numeric array indicating the indices of the input and output points stored in
the model that should be deleted.</p></td>
    </tr>
    <tr>
      <th>var.sb</th>
      <td><p>an optional number indicating the value that should be used to substitute the current
variance parameter of the model.</p></td>
    </tr>
    <tr>
      <th>ls_s.sb</th>
      <td><p>an optional numerical array indicating the values that should be used to substitute the
current length-scale parameters for the scalar inputs of the model.</p></td>
    </tr>
    <tr>
      <th>ls_f.sb</th>
      <td><p>an optional numerical array indicating the values that should be used to substitute the
current length-scale parameters for the functional inputs of the model.</p></td>
    </tr>
    <tr>
      <th>var.re</th>
      <td><p>an optional boolean indicating wether the variance parameter should be re-estimated.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>ls_s.re</th>
      <td><p>an optional boolean indicating wether the length-scale parameters of the scalar inputs
should be re-estimated. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>ls_f.re</th>
      <td><p>an optional boolean indicating wether the length-scale parameters of the functional
inputs should be re-estimated. Default is FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='fgpm-class.html'>fgpm</a> representing the updated funGp model.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The arguments listed above enable the completion of the following updating tasks:</p><ul>
<li><p><strong>Deletion</strong> of data points: ind.dl;</p></li>
<li><p><strong>Addition</strong> of data points: sIn.nw, fIn.nw, sOut.nw;</p></li>
<li><p><strong>Substitution</strong> of data points: sIn.sb, fIn.sb, sOut.sb, ind.sb;</p></li>
<li><p><strong>Substitution</strong> of hyperparameters: var.sb, ls_s.sb, ls_f.sb;</p></li>
<li><p><strong>Re-estimation</strong> of hyperparameters: var.re, ls_s.re, ls_f.re.</p></li>
</ul>

<p>All the arguments listed above are optional since any of these tasks can be requested without need to
request any of the other tasks. In fact, even most of the arguments can be used even if the other
arguments related to the same task are not. For instance, the re-estimation of the variance can be
requested via var.re without requiring re-estimation of the scalar or functional length-scale
parameters. The only two exceptions are: (i) for data addition, the new output sOut.nw should always
be provided and the new input points should correspond to the set of variables already stored in the
<a href='fgpm-class.html'>fgpm</a> object passed for update; and (ii) for data substitution, the argument ind.sb is
always mandatory.</p>
<p><strong>Conflictive task combinations:</strong></p><ul>
<li><p>Data points deletion and substitution;</p></li>
<li><p>Substitution and re-estimation of the same hyperparameter.</p></li>
</ul>

<p>Note that the parameters of the model will not be updated after modifying the model unless explicitly
requested through the var.re, ls_s.re and ls_f.re arguments. If, for instance, some points are added
to the model without requesting parameters re-estimation, the new data will be included in the
training-training and training-prediction covariance matrices, but the hyperparameters will not
be updated. This allows to make updates in the data that might help to improve predictions,
without the immediate need to perform a training procedure that could be time consuming. At any later
time, the user is allowed to request the re-estimation of the hyperparameters, which will make
the model be fully up to date.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><strong>*</strong> <a href='fgpm.html'>fgpm</a> for creation of a funGp model;</p>
<p><strong>*</strong> <a href='predict-methods.html'>predict</a> for predictions based on a funGp model;</p>
<p><strong>*</strong> <a href='simulate-methods.html'>simulate</a> for simulations based on a funGp model;</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># deletion and addition of data points_____________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgpm.html'>fgpm</a></span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># deleting two points</span>
<span class='no'>ind.dl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='no'>m1</span>@<span class='kw'>n.tot</span>, <span class='fl'>2</span>)
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>ind.dl</span> <span class='kw'>=</span> <span class='no'>ind.dl</span>)

<span class='co'># adding five points</span>
<span class='no'>n.nw</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>
<span class='no'>sIn.nw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.nw</span> * <span class='no'>m1</span>@<span class='kw'>ds</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>n.nw</span>)
<span class='no'>fIn.nw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.nw</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.nw</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut.nw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn.nw</span>, <span class='no'>fIn.nw</span>, <span class='no'>n.nw</span>)
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>sIn.nw</span> <span class='kw'>=</span> <span class='no'>sIn.nw</span>, <span class='kw'>fIn.nw</span> <span class='kw'>=</span> <span class='no'>fIn.nw</span>, <span class='kw'>sOut.nw</span> <span class='kw'>=</span> <span class='no'>sOut.nw</span>)


<span class='co'># substitution of data points______________________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgpm.html'>fgpm</a></span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># generating substituting input data for updating</span>
<span class='no'>n.sb</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>sIn.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.sb</span> * <span class='no'>m1</span>@<span class='kw'>ds</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>n.sb</span>)
<span class='no'>fIn.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.sb</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.sb</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))

<span class='co'># generating substituting output data for updating</span>
<span class='no'>sOut.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn.sb</span>, <span class='no'>fIn.sb</span>, <span class='no'>n.sb</span>)

<span class='co'># generating indices for substitution</span>
<span class='no'>ind.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:(<span class='no'>m1</span>@<span class='kw'>n.tot</span>), <span class='no'>n.sb</span>)

<span class='co'># updating all, the scalar inputs, functional inputs and the output</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>sIn.sb</span> <span class='kw'>=</span> <span class='no'>sIn.sb</span>, <span class='kw'>fIn.sb</span> <span class='kw'>=</span> <span class='no'>fIn.sb</span>, <span class='kw'>sOut.sb</span> <span class='kw'>=</span> <span class='no'>sOut.sb</span>, <span class='kw'>ind.sb</span> <span class='kw'>=</span> <span class='no'>ind.sb</span>)

<span class='co'># updating only some of the data structures</span>
<span class='no'>m1up1</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>sIn.sb</span> <span class='kw'>=</span> <span class='no'>sIn.sb</span>, <span class='kw'>ind.sb</span> <span class='kw'>=</span> <span class='no'>ind.sb</span>) <span class='co'># only the scalar inputs</span>
<span class='no'>m1up2</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>sOut.sb</span> <span class='kw'>=</span> <span class='no'>sOut.sb</span>, <span class='kw'>ind.sb</span> <span class='kw'>=</span> <span class='no'>ind.sb</span>) <span class='co'># only the output</span>
<span class='no'>m1up3</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>sIn.sb</span> <span class='kw'>=</span> <span class='no'>sIn.sb</span>, <span class='kw'>sOut.sb</span> <span class='kw'>=</span> <span class='no'>sOut.sb</span>, <span class='kw'>ind.sb</span> <span class='kw'>=</span> <span class='no'>ind.sb</span>) <span class='co'># the scalar inputs</span>
                                                                         <span class='co'># and the output</span>


<span class='co'># substitution of hyperparameters__________________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgpm.html'>fgpm</a></span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># defining hyperparameters for substitution</span>
<span class='no'>var.sb</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>ls_s.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2.44</span>, <span class='fl'>1.15</span>)
<span class='no'>ls_f.sb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5.83</span>, <span class='fl'>4.12</span>)

<span class='co'># updating the model</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>var.sb</span> <span class='kw'>=</span> <span class='no'>var.sb</span>, <span class='kw'>ls_s.sb</span> <span class='kw'>=</span> <span class='no'>ls_s.sb</span>, <span class='kw'>ls_f.sb</span> <span class='kw'>=</span> <span class='no'>ls_f.sb</span>)


<span class='co'># re-estimation of hyperparameters_________________________________________________________</span>
<span class='co'># building the model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>n.tr</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB3.html'>fgp_BB3</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgpm.html'>fgpm</a></span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># re-estimating the hyperparameters</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>var.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># only the variance</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>ls_s.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># only the scalar length-scale parameters</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>ls_s.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ls_f.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># all length-scale parameters</span>
<span class='no'>m1up</span> <span class='kw'>&lt;-</span> <span class='fu'>update</span>(<span class='no'>m1</span>, <span class='kw'>var.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ls_s.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>ls_f.re</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># all hyperparameters</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by José Betancourt, François Bachoc, Thierry Klein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


