<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Structural optimization of Gaussian process models — fgpm_factory • funGp</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Structural optimization of Gaussian process models — fgpm_factory" />

<meta property="og:description" content="This function enables the smart exploration of the solution space of potential structural
  configurations of a funGp model, and the consequent selection of a high quality configuration. funGp
  currently relies on an ant colony based algorithm to perform this task. The algorithm defines the
  solution space based on the levels of each structural parameter currently available in the
  fgpm function, and performs as smart exploration of it. More details on the algorithm are
  provided in a dedicated
  technical report.
  funGp might evolve in the future to include improvements in the current algorithm or alternative
  solution methods." />

<meta property="og:image" content="/logo.png" />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funGp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/djbetancourt-gh/funGp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Structural optimization of Gaussian process models</h1>
    
    <div class="hidden name"><code>fgpm_factory.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function enables the smart exploration of the solution space of potential structural
  configurations of a funGp model, and the consequent selection of a high quality configuration. funGp
  currently relies on an ant colony based algorithm to perform this task. The algorithm defines the
  solution space based on the levels of each structural parameter currently available in the
  <a href='fgpm.html'>fgpm</a> function, and performs as smart exploration of it. More details on the algorithm are
  provided in a dedicated
  <a href='https://drive.google.com/file/d/1GnalLS9jEr9AxPKmQk0S1bLQ7whuLm1T/view?usp=sharing'>technical report</a>.
  funGp might evolve in the future to include improvements in the current algorithm or alternative
  solution methods.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fgpm_factory</span>(
  <span class='kw'>sIn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ind.vl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ctraints</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>setup</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>time.lim</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>,
  <span class='kw'>n.starts</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>n.presample</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>par.clust</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>quietly</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sIn</th>
      <td><p>an optional matrix of scalar input values to train the model. Each column must match an input
variable and each row a training point. Either scalar input coordinates (sIn), functional input
coordinates (fIn), or both must be provided.</p></td>
    </tr>
    <tr>
      <th>fIn</th>
      <td><p>an optional list of functional input values to train the model. Each element of the list must
be a matrix containing to the set of curves corresponding to one functional input. Either scalar input
coordinates (sIn), functional input coordinates (fIn), or both must be provided.</p></td>
    </tr>
    <tr>
      <th>sOut</th>
      <td><p>a vector (or 1-column matrix) containing the values of the scalar output at the specified
input points.</p></td>
    </tr>
    <tr>
      <th>ind.vl</th>
      <td><p>an optional numerical matrix specifying which points in the three structures above should be
used for training and which for validation. If provided, the optimization will be conducted in terms of
the hold-out Q2, which comes from training the model with a subset of the points, and then estimate the
prediction error in the remaining points. In that case, each column of <em>ind.vl</em> will be interpreted
as one validation set, and the multiple columns will imply replicates. In the simplest case,
<em>ind.vl</em> will be a one-column matrix or simply an array, meaning that a simple replicate should be
used for each model configuration explored. If not provided, the optimization will be conducted in terms
of the leave-one-out cross-validation Q2, which for a total number of n observations, comes from training
the model n times, each using n-1 points for training and the remaining one for validation. This procedure
is tipically costly due to the large number of hyperparameters optimizations that should be conducted,
nonetheless, fgpm_factory implements the virtual equations introduced by Dubrule (1983) for Gaussian
processes, which require a single hyperparameters optimization. See the reference below for more details.</p></td>
    </tr>
    <tr>
      <th>ctraints</th>
      <td><p>an optional list specifying the constraints of the structural optimization problem. Valid
entries for this list are: <br /><br />
<strong>*</strong><em>s_keepOn</em>: a numerical array indicating the scalar inputs that should remain active in the
  model. It should contain the index of the columns of sIn corresponding to the inputs to keep active. <br /><br />
<strong>*</strong><em>f_keepOn</em>: a numerical array indicating the functional inputs that should remain active in
  the model. It should contain the index of the elements of fIn corresponding to the inputs to keep active. <br /><br />
<strong>*</strong><em>f_disTypes</em>: a list specifying the set of distances that should be tested for some
  functional inputs. The values should be taken from the possibilities offered by the <a href='fgpm.html'>fgpm</a>
  function for the argument <em>f_disType</em> therein. Valid choices at this time are "L2_bygroup" and
  "L2_byindex". Each element of the list should receive as name the index of a functional input variable,
  and should contain an array of strings with the name of the distances allowed for this input. All the
  available distances will be tried for any functional input not included in the list. <br /><br />
<strong>*</strong><em>f_fixDims</em>: a two-row matrix specifying a particular projection dimension for some
  functional inputs. For each input, the value should be a number between 0 and its original dimension,
  with 0 denoting no projection. The first row of the matrix should contain the index of each input, and
  the second row should contain the corresponding dimensions. All the possible dimensions will be tried
  for any functional input not included in the matrix (unless affected by the <em>f_maxDims</em> argument
  below). <br /><br />
<strong>*</strong><em>f_maxDims</em>: a two-row matrix specifying the largest projection dimension for some
  functional inputs. For each input, the value should be a number between 1 and its original dimension.
  The first row of the matrix should contain the index of each input, and the second row should contain
  the corresponding largest dimensions. All the possible dimensions will be tried for any functional input
  not included in the matrix (unless affected by the <em>f_fixDims</em> argument above). <br /><br />
<strong>*</strong><em>f_basTypes</em>: a list specifying the set of basis families that should be tested for some
  functional inputs. The values should be taken from the possibilities offered by the <a href='fgpm.html'>fgpm</a>
  function for the argument <em>f_basType</em> therein. Valid choices at this time are "B-splines" and "PCA".
  Each element of the list should receive as name the index of a functional input variable, and should
  contain an array of strings with the name of the distances allowed for this input. All the available
  basis families will be tried for any functional input not included in the list. <br /><br />
<strong>*</strong><em>kerTypes</em>: an array of strings specifying the kernel functions allowed to be tested. The
  values should be taken from the possibilities offered by the <a href='fgpm.html'>fgpm</a> function for the argument
  <em>kerType</em> therein. Valid choices at this time are "gauss", "matern5_2" and "matern3_2". If not
  provided, all the available kernel functions will be tried.</p></td>
    </tr>
    <tr>
      <th>setup</th>
      <td><p>an optional list indicating the value for some parameters of the structural optimization
algorithm. The ant colony optimization algorithm available at this time allows the following entries: <br /><br />
<strong>Initial pheromone load</strong><br /><br />
  <strong>*</strong><em>tao0</em>: a number indicating the initial pheromone load on links pointing out to the
    selection of a distance type, a projection basis or a kernel type. Default is 0.1. <br /><br />
  <strong>*</strong><em>dop.s</em>: a number controlling how likely is to activate a scalar input. It operates on a
    relation of the type \(A  = dop.s * I\), where <em>A</em> is the initial pheromone load of links
    pointing out to the activation of scalar inputs and <em>I</em> is the initial pheromone load of links
    pointing out to their inactivation. Default is 1. <br /><br />
  <strong>*</strong><em>dop.f</em>: analogous to <em>dop.s</em> for functional inputs. Default is 1. <br /><br />
  <strong>*</strong><em>delta.f and dispr.f</em>: two numbers used as shape parameters for the regularization
    function that determines the initial pheromone values on the links connecting the L2_byindex distance
    with the projection dimension. Default are 2 and 1.4, respectively. <br /><br />
<strong>Local pheromone update</strong><br /><br />
  <strong>*</strong><em>rho.l</em>: a number specifying the pheromone evaporation rate. Default is 0.1 <br /><br />
<strong>Global pheromone update</strong><br /><br />
  <strong>*</strong><em>u.gbest</em>: a boolean indicating if at each iterations, the pheromone load on the links
    of the best ant of the whole trial should be reinforced. Default is FALSE. <br /><br />
  <strong>*</strong><em>n.ibest</em>: a number inficating how many top ants of each iteration should be used for
    pheromone reinforcement. Default is 1. <br /><br />
  <strong>*</strong><em>rho.g</em>: a number specifying the learning reinforcement rate. Default is 0.1. <br /><br />
<strong>Population factors</strong><br /><br />
  <strong>*</strong><em>n.iter</em>: a number specifying the amount of iterations of the algorithm. Default is 15. <br /><br />
  <strong>*</strong><em>n.pop</em>: a number specifying the amount of ants per iteration; each ant corresponds to one
    structural configuration for the model. Default is 10. <br /><br />
<strong>Bias strength</strong><br /><br />
  <strong>*</strong><em>q0</em>: ants use one of two rules to select their next node at each step. The first rule leads
    the ant through the link with higher pheromone load; the second rule works based on probabilities which
    are proportional to the pheromone load on the feasible links. The ants will randomly chose one of the two
    rules at each time. They will opt for rule 1 with probability <em>q0</em>. Default is 0.95.</p></td>
    </tr>
    <tr>
      <th>time.lim</th>
      <td><p>an optional number specifying a time limit in seconds to be used as stopping condition for the
structural optimization.</p></td>
    </tr>
    <tr>
      <th>nugget</th>
      <td><p>an optional variance value standing for the homogeneous nugget effect. A tiny nugget might help
to overcome numerical problems related to the ill-conditioning of the covariance matrix. Default is 1e-8.</p></td>
    </tr>
    <tr>
      <th>n.starts</th>
      <td><p>an optional integer indicating the number of initial points to use for the optimization of the
hyperparameters. A parallel processing cluster can be exploited in order to speed up the evaluation of
multiple initial points. More details in the description of the argument par.clust below. Default is 1.</p></td>
    </tr>
    <tr>
      <th>n.presample</th>
      <td><p>an optional integer indicating the number of points to be tested in order to select the
n.starts intial points. The n.presampre points will be randomly sampled from the hyper-rectangle defined by: <br /> <br />
1e-10 \(\le\) <code>ls_s.hyp[i]</code> \(\le\) 2*max(<code>sMs[[i]]</code>), for i in 1 to the number of scalar inputs, <br />
1e-10 \(\le\) <code>ls_f.hyp[i]</code> \(\le\) 2*max(<code>fMs[[i]]</code>), for i in 1 to the number of functional inputs, <br /> <br />
with  sMs and fMs the lists of distance matrices for the scalar and functional inputs, respectively. The value of
n.starts will be assigned to n.presample if this last is smaller. Default is 20.</p></td>
    </tr>
    <tr>
      <th>par.clust</th>
      <td><p>an optional parallel processing cluster created with the <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code>
function of the parallel package. If not provided, structural configurations are evaluated in
sequence.</p></td>
    </tr>
    <tr>
      <th>quietly</th>
      <td><p>an optional boolean indicating in the calls to fgpm should ommit text related to the optimization
of the hyperparameters. Parallelized optimizations are always performed quietly. Default is TRUE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='Xfgpm-class.html'>Xfgpm</a> containing the data structures linked to the structural optimization
  of a funGp model. It includes as the main component, an object of class <a href='fgpm-class.html'>fgpm</a> corresponding to the
  optimized model. It is accessible through the <code>@model</code> slot of the Xfgpm object.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Betancourt, J., Bachoc, F., Klein, T., Idier, D., Pedreros, R., and Rohmer, J. (2020),
"Gaussian process metamodeling of functional-input code for coastal flood hazard assessment".
<em>Reliability Engineering &amp; System Safety</em>, <strong>198</strong>, 106870.
<a href='https://www.sciencedirect.com/science/article/abs/pii/S0951832019301693'>[RESS]</a>
<a href='https://hal.archives-ouvertes.fr/hal-01998724'>[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., Klein, T., and Gamboa, F. (2020),
Technical Report: "Ant Colony Based Model Selection for Functional-Input Gaussian Process Regression. Ref. B3D-WP3.2".
<em>RISCOPE project</em>.
<a href='https://drive.google.com/file/d/1GnalLS9jEr9AxPKmQk0S1bLQ7whuLm1T/view?usp=sharing'>[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., and Klein, T. (2020),
R Package Manual: "Gaussian Process Regression for Scalar and Functional Inputs with funGp - The in-depth tour".
<em>RISCOPE project</em>.
<a href='https://drive.google.com/file/d/1MtYi-Qq-BNZpbp1SWWG4Fb35HvVqRHQM/view?usp=sharing'>[HAL]</a></p>
<p>Dubrule, O. (1983),
"Cross validation of kriging in a unique neighborhood".
<em>Journal of the International Association for Mathematical Geology</em>, <strong>15</strong>,  687-699.
<a href='https://link.springer.com/article/10.1007/BF01033232'>[MG]</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><strong>*</strong> <a href='plotX-methods.html'>plotX</a> for diagnostic plots for a fgpm_factory output and selected model;</p>
<p><strong>*</strong> <a href='plotEvol-methods.html'>plotEvol</a> for a plot of the evolution of the model selection algorithm in fgpm_factory;</p>
<p><strong>*</strong> <a href='predict-methods.html'>predict</a> for predictions based on a funGp model;</p>
<p><strong>*</strong> <a href='simulate-methods.html'>simulate</a> for simulations based on a funGp model;</p>
<p><strong>*</strong> <a href='update-methods.html'>update</a> for post-creation updates on a funGp model.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># calling fgpm_factory with the default arguments__________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='co'># \donttest{</span>
<span class='co'># optimizing the model structure with fgpm_factory (~5 seconds)</span>
<span class='no'>xm</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>xm</span>@<span class='kw'>model</span>) <span class='co'># plotting the model</span>

<span class='co'># building the model with the default fgpm arguments to compare</span>
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgpm.html'>fgpm</a></span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>m1</span>) <span class='co'># plotting the model</span>

<span class='co'># assessing the quality of the model</span>
<span class='co'># in the absolute and also w.r.t. the other explored models</span>
<span class='fu'><a href='plotX-methods.html'>plotX</a></span>(<span class='no'>xm</span>)

<span class='co'># checking the evolution of the algorithm</span>
<span class='fu'><a href='plotEvol-methods.html'>plotEvol</a></span>(<span class='no'>xm</span>)
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># improving performance with more iterations_______________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># default of 15 iterations (~5 seconds)</span>
<span class='no'>xm15</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)

<span class='co'># increasing to 25 iterations (~16 seconds)</span>
<span class='no'>xm25</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>setup</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>25</span>))

<span class='co'># plotting both models</span>
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>xm15</span>@<span class='kw'>model</span>)
<span class='fu'><a href='plotLOO-methods.html'>plotLOO</a></span>(<span class='no'>xm25</span>@<span class='kw'>model</span>)
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># custom solution space____________________________________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># setting up the constraints</span>
<span class='no'>myctr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>s_keepOn</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='co'># keep both scalar inputs always on</span>
              <span class='kw'>f_keepOn</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>), <span class='co'># keep f2 always active</span>
              <span class='kw'>f_disTypes</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"2"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"L2_byindex"</span>)), <span class='co'># only use L2_byindex distance for f2</span>
              <span class='kw'>f_fixDims</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>1</span>), <span class='co'># f2 projected in dimension 4</span>
              <span class='kw'>f_maxDims</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>5</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>1</span>), <span class='co'># f1 projected in dimension max 5</span>
              <span class='kw'>f_basTypes</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"1"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"B-splines"</span>)), <span class='co'># only use B-splines projection for f1</span>
              <span class='kw'>kerTypes</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"matern5_2"</span>, <span class='st'>"gauss"</span>)) <span class='co'># test only Matern 5/2 and Gaussian kernels</span>

<span class='co'># calling the funGp factory with specific constraints (~12 seconds)</span>
<span class='no'>xm</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>ctraints</span> <span class='kw'>=</span> <span class='no'>myctr</span>)

<span class='co'># verifying constraints with the log of some successfully built models</span>
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>xm</span>@<span class='kw'>log.success</span>@<span class='kw'>sols</span>, <span class='st'>"Q2"</span> <span class='kw'>=</span> <span class='no'>xm</span>@<span class='kw'>log.success</span>@<span class='kw'>fitness</span>)
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># custom heuristic parameters______________________________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># defining the heuristic parameters</span>
<span class='no'>mysup</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>n.pop</span> <span class='kw'>=</span> <span class='fl'>12</span>, <span class='kw'>tao0</span> <span class='kw'>=</span> <span class='fl'>.15</span>, <span class='kw'>dop.s</span> <span class='kw'>=</span> <span class='fl'>1.2</span>, <span class='kw'>dop.f</span> <span class='kw'>=</span> <span class='fl'>1.3</span>, <span class='kw'>delta.f</span> <span class='kw'>=</span> <span class='fl'>4</span>,
              <span class='kw'>dispr.f</span> <span class='kw'>=</span> <span class='fl'>1.1</span>, <span class='kw'>q0</span> <span class='kw'>=</span> <span class='fl'>.85</span>, <span class='kw'>rho.l</span> <span class='kw'>=</span> <span class='fl'>.2</span>, <span class='kw'>u.gbest</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>n.ibest</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>rho.g</span> <span class='kw'>=</span> <span class='fl'>.08</span>)

<span class='co'># calling the funGp factory with a custom heuristic setup (~21 seconds)</span>
<span class='no'>xm</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>setup</span> <span class='kw'>=</span> <span class='no'>mysup</span>)

<span class='co'># verifying heuristic setup through the details of the Xfgpm object</span>
<span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='no'>xm</span>@<span class='kw'>details</span>$<span class='no'>param</span>)
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># stopping condition based on time_________________________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># setting up a sufficiently large number of iterations</span>
<span class='no'>mysup</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>2000</span>)

<span class='co'># defining time budget</span>
<span class='no'>mytlim</span> <span class='kw'>&lt;-</span> <span class='fl'>60</span>

<span class='co'># calling the funGp factory with time limit (~60 seconds)</span>
<span class='no'>xm</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>setup</span> <span class='kw'>=</span> <span class='no'>mysup</span>, <span class='kw'>time.lim</span> <span class='kw'>=</span> <span class='no'>mytlim</span>)
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># passing fgpm arguments through fgpm_factory______________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>^<span class='fl'>5</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)
<span class='co'># calling the funGp factory with custom fgpm parameters (~8 seconds)</span>
<span class='no'>xm</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>,
                   <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>n.starts</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>n.presample</span> <span class='kw'>=</span> <span class='fl'>12</span>)

<span class='co'># NOTE: in the run above, some models crash. This happens because we set the nugget to 0</span>
<span class='co'>#       and some input points become duplicates when some variables are removed from</span>
<span class='co'>#       the model. We strongly recommend to always run fgpm_factory with at least a</span>
<span class='co'>#       small nugget in order to prevent loss of configurations. By default fgpm_factory</span>
<span class='co'>#       runs with 1e-8, which is enough in most cases.</span>
<span class='no'>xm</span>@<span class='kw'>log.crashes</span>
<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='co'># parallelization in the model factory_____________________________________________________</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>243</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># calling fgpm_factory in parallel</span>
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>3</span>)
<span class='no'>xm.par</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>par.clust</span> <span class='kw'>=</span> <span class='no'>cl</span>) <span class='co'>#  (~119 seconds)</span>
<span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)

<span class='co'># ----------&lt; small experiment to show benfit of paralellization in fgpm_factory</span>
<span class='co'># generating input and output data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>100</span>)
<span class='no'>n.tr</span> <span class='kw'>&lt;-</span> <span class='fl'>243</span>
<span class='no'>sIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)), <span class='kw'>x4</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)),
                   <span class='kw'>x5</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>length</span> <span class='kw'>=</span> <span class='no'>n.tr</span>^(<span class='fl'>1</span>/<span class='fl'>5</span>)))
<span class='no'>fIn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>f1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>10</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>f2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>n.tr</span>*<span class='fl'>22</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>22</span>))
<span class='no'>sOut</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fgp_BB7.html'>fgp_BB7</a></span>(<span class='no'>sIn</span>, <span class='no'>fIn</span>, <span class='no'>n.tr</span>)

<span class='co'># to run the factory in sequence</span>
<span class='no'>fact_seq</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() {
  <span class='no'>xm.seq</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>)
}

<span class='co'># to run the factory in parallel</span>
<span class='no'>fact_par</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>() {
  <span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>3</span>)
  <span class='no'>xm.par</span> <span class='kw'>&lt;-</span> <span class='fu'>fgpm_factory</span>(<span class='kw'>sIn</span> <span class='kw'>=</span> <span class='no'>sIn</span>, <span class='kw'>fIn</span> <span class='kw'>=</span> <span class='no'>fIn</span>, <span class='kw'>sOut</span> <span class='kw'>=</span> <span class='no'>sOut</span>, <span class='kw'>par.clust</span> <span class='kw'>=</span> <span class='no'>cl</span>)
  <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)
}

<span class='co'># performance test</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>microbenchmark</span>)
<span class='fu'><a href='https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html'>microbenchmark</a></span>(<span class='fu'>fact_seq</span>(), <span class='fu'>fact_par</span>(), <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>3</span>) <span class='co'># NOTE: this might take ~ 19 min!</span>

<span class='co'># ~R output:~</span>
<span class='co'># Unit: seconds</span>
<span class='co'>#       expr       min        lq     mean    median       uq      max neval</span>
<span class='co'># fact_seq() 126.69960 164.49382 242.2199 202.28804 299.9801 397.6722     3</span>
<span class='co'># fact_par()  88.10726  92.05694 118.8896  96.00663 134.2807 172.5548     3</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by José Betancourt, François Bachoc, Thierry Klein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


