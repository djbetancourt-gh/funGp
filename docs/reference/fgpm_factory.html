<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Structural optimization of Gaussian process models — fgpm_factory • funGp</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Structural optimization of Gaussian process models — fgpm_factory"><meta property="og:description" content="This function enables the smart exploration of the solution space of potential structural
  configurations of a funGp model, and the consequent selection of a high quality configuration. funGp
  currently relies on an ant colony based algorithm to perform this task. The algorithm defines the
  solution space based on the levels of each structural parameter currently available in the
  fgpm function, and performs a smart exploration of it. More details on the algorithm are
  provided in a dedicated
  technical report.
  funGp might evolve in the future to include improvements in the current algorithm or alternative
  solution methods."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">funGp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/djbetancourt-gh/funGp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Structural optimization of Gaussian process models</h1>
    <small class="dont-index">Source: <a href="https://github.com/djbetancourt-gh/funGp/blob/HEAD/R/1_Xfgpm_Class.R" class="external-link"><code>R/1_Xfgpm_Class.R</code></a></small>
    <div class="hidden name"><code>fgpm_factory.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function enables the smart exploration of the solution space of potential structural
  configurations of a funGp model, and the consequent selection of a high quality configuration. funGp
  currently relies on an ant colony based algorithm to perform this task. The algorithm defines the
  solution space based on the levels of each structural parameter currently available in the
  <a href="fgpm.html">fgpm</a> function, and performs a smart exploration of it. More details on the algorithm are
  provided in a dedicated
  <a href="https://hal.archives-ouvertes.fr/hal-02532713" class="external-link">technical report</a>.
  funGp might evolve in the future to include improvements in the current algorithm or alternative
  solution methods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">fgpm_factory</span><span class="op">(</span>
  sIn <span class="op">=</span> <span class="cn">NULL</span>,
  fIn <span class="op">=</span> <span class="cn">NULL</span>,
  sOut <span class="op">=</span> <span class="cn">NULL</span>,
  ind.vl <span class="op">=</span> <span class="cn">NULL</span>,
  ctraints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  setup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  time.lim <span class="op">=</span> <span class="cn">Inf</span>,
  nugget <span class="op">=</span> <span class="fl">1e-08</span>,
  n.starts <span class="op">=</span> <span class="fl">1</span>,
  n.presample <span class="op">=</span> <span class="fl">20</span>,
  par.clust <span class="op">=</span> <span class="cn">NULL</span>,
  trace <span class="op">=</span> <span class="cn">TRUE</span>,
  pbars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sIn</dt>
<dd><p>An optional matrix of scalar input values to train the model. Each column must match an input
variable and each row a training point. Either scalar input coordinates (sIn), functional input
coordinates (fIn), or both must be provided.</p></dd>


<dt>fIn</dt>
<dd><p>An optional list of functional input values to train the model. Each element of the list must
be a matrix containing the set of curves corresponding to one functional input. Either scalar input
coordinates (sIn), functional input coordinates (fIn), or both must be provided.</p></dd>


<dt>sOut</dt>
<dd><p>A vector (or 1-column matrix) containing the values of the scalar output at the specified
input points.</p></dd>


<dt>ind.vl</dt>
<dd><p>An optional numerical matrix specifying which points in the three structures above should be
used for training and which for validation. If provided, the optimization will be conducted in terms of
the hold-out coefficient of determination Q², which comes from training the model with a subset of the points, and then estimating the
prediction error in the remaining points. In that case, each column of <em>ind.vl</em> will be interpreted
as one validation set, and the multiple columns will imply replicates. In the simplest case,
<em>ind.vl</em> will be a one-column matrix or simply an array, meaning that a simple replicate should be
used for each model configuration explored. If not provided, the optimization will be conducted in terms
of the leave-one-out cross-validation Q², which for a total number of n observations, comes from training
the model n times, each using n-1 points for training and the remaining one for validation. This procedure
is typically costly due to the large number of hyperparameter optimizations that should be conducted,
nonetheless, fgpm_factory implements the virtual equations introduced by Dubrule (1983) for Gaussian
processes, which require a single hyperparameter optimization. See the reference below for more details.</p></dd>


<dt>ctraints</dt>
<dd><p>An optional list specifying the constraints of the structural optimization problem. Valid
entries for this list are: <br><br><strong>*</strong><em>s_keepOn</em>: a numerical array indicating the scalar inputs that should remain active in the
  model. It should contain the indices of the columns of sIn corresponding to the inputs to keep active. <br><br><strong>*</strong><em>f_keepOn</em>: a numerical array indicating the functional inputs that should remain active in
  the model. It should contain the indices of the elements of fIn corresponding to the inputs to keep active. <br><br><strong>*</strong><em>f_disTypes</em>: a list specifying the set of distances that should be tested for some
  functional inputs. The values should be taken from the possibilities offered by the <a href="fgpm.html">fgpm</a>
  function for the argument <em>f_disType</em> therein. Valid choices at this time are "L2_bygroup" and
  "L2_byindex". Each element of the list should receive as name the index of a functional input variable,
  and should contain an array of strings with the name of the distances allowed for this input. All the
  available distances will be tried for any functional input not included in the list. <br><br><strong>*</strong><em>f_fixDims</em>: a two-row matrix specifying a particular projection dimension for some
  functional inputs. For each input, the value should be a number between 0 and its original dimension,
  with 0 denoting no projection. The first row of the matrix should contain the index of each input, and
  the second row should contain the corresponding dimensions. All the possible dimensions will be tried
  for any functional input not included in the matrix (unless affected by the <em>f_maxDims</em> argument
  below). <br><br><strong>*</strong><em>f_maxDims</em>: a two-row matrix specifying the largest projection dimension for some
  functional inputs. For each input, the value should be a number between 1 and its original dimension.
  The first row of the matrix should contain the index of each input, and the second row should contain
  the corresponding largest dimensions. All the possible dimensions will be tried for any functional input
  not included in the matrix (unless affected by the <em>f_fixDims</em> argument above). <br><br><strong>*</strong><em>f_basTypes</em>: a list specifying the set of basis families that should be tested for some
  functional inputs. The values should be taken from the possibilities offered by the <a href="fgpm.html">fgpm</a>
  function for the argument <em>f_basType</em> therein. Valid choices at this time are "B-splines" and "PCA".
  Each element of the list should receive as name the index of a functional input variable, and should
  contain an array of strings with the name of the distances allowed for this input. All the available
  basis families will be tried for any functional input not included in the list. <br><br><strong>*</strong><em>kerTypes</em>: an array of strings specifying the kernel functions allowed to be tested. The
  values should be taken from the possibilities offered by the <a href="fgpm.html">fgpm</a> function for the argument
  <em>kerType</em> therein. Valid choices at this time are "gauss", "matern5_2" and "matern3_2". If not
  provided, all the available kernel functions will be tried.</p></dd>


<dt>setup</dt>
<dd><p>An optional list indicating the value for some parameters of the structural optimization
algorithm. The ant colony optimization algorithm available at this time allows the following entries: <br><br><strong>Initial pheromone load</strong><br><br><strong>*</strong><em>tao0</em>: a number indicating the initial pheromone load on links pointing out to the
    selection of a distance type, a projection basis or a kernel type. Default is 0.1. <br><br><strong>*</strong><em>dop.s</em>: a number controlling how likely it is to activate a scalar input. It operates on a
    relation of the type \(A  = dop.s * I\), where <em>A</em> is the initial pheromone load of links
    pointing out to the activation of scalar inputs and <em>I</em> is the initial pheromone load of links
    pointing out to their inactivation. Default is 1. <br><br><strong>*</strong><em>dop.f</em>: analogous to <em>dop.s</em> for functional inputs. Default is 1. <br><br><strong>*</strong><em>delta.f and dispr.f</em>: two numbers used as shape parameters for the regularization
    function that determines the initial pheromone values on the links connecting the L2_byindex distance
    with the projection dimension. Default are 2 and 1.4, respectively. <br><br><strong>Local pheromone update</strong><br><br><strong>*</strong><em>rho.l</em>: a number specifying the pheromone evaporation rate. Default is 0.1. <br><br><strong>Global pheromone update</strong><br><br><strong>*</strong><em>u.gbest</em>: a boolean indicating if at each iteration, the pheromone load on the links
    of the best ant of the whole trial should be reinforced. Default is FALSE. <br><br><strong>*</strong><em>n.ibest</em>: a number indicating how many top ants of each iteration should be used for
    pheromone reinforcement. Default is 1. <br><br><strong>*</strong><em>rho.g</em>: a number specifying the learning reinforcement rate. Default is 0.1. <br><br><strong>Population factors</strong><br><br><strong>*</strong><em>n.iter</em>: a number specifying the amount of iterations of the algorithm. Default is 15. <br><br><strong>*</strong><em>n.pop</em>: a number specifying the amount of ants per iteration; each ant corresponds to one
    structural configuration for the model. Default is 10. <br><br><strong>Bias strength</strong><br><br><strong>*</strong><em>q0</em>: ants use one of two rules to select their next node at each step. The first rule leads
    the ant through the link with higher pheromone load; the second rule works based on probabilities which
    are proportional to the pheromone load on the feasible links. The ants will randomly chose one of the two
    rules at each time. They will opt for rule 1 with probability <em>q0</em>. Default is 0.95.</p></dd>


<dt>time.lim</dt>
<dd><p>An optional number specifying a time limit in seconds to be used as stopping condition for the
structural optimization.</p></dd>


<dt>nugget</dt>
<dd><p>An optional variance value standing for the homogeneous nugget effect. A tiny nugget might help
to overcome numerical problems related to the ill-conditioning of the covariance matrix. Default is 1e-8.</p></dd>


<dt>n.starts</dt>
<dd><p>An optional integer indicating the number of initial points to use for the optimization of the
hyperparameters. A parallel processing cluster can be exploited in order to speed up the evaluation of
multiple initial points. More details in the description of the argument par.clust below. Default is 1.</p></dd>


<dt>n.presample</dt>
<dd><p>An optional integer indicating the number of points to be tested in order to select the
n.starts initial points. The n.presample points will be randomly sampled from the hyper-rectangle defined by: <br><br>
1e-10 \(\le\) <code>ls_s.hyp[i]</code> \(\le\) 2*max(<code>sMs[[i]]</code>), for i in 1 to the number of scalar inputs, <br>
1e-10 \(\le\) <code>ls_f.hyp[i]</code> \(\le\) 2*max(<code>fMs[[i]]</code>), for i in 1 to the number of functional inputs, <br><br>
with  sMs and fMs the lists of distance matrices for the scalar and functional inputs, respectively. The value of
n.starts will be assigned to n.presample if this last is smaller. Default is 20.</p></dd>


<dt>par.clust</dt>
<dd><p>An optional parallel processing cluster created with the <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code>
function of the parallel package. If not provided, structural configurations are evaluated in
sequence.</p></dd>


<dt>trace</dt>
<dd><p>An optional boolean indicating if control messages native of the <a href="funGp-package.html">funGp package</a> should be
printed to console. Default is TRUE. For complementary control on the display of funGp-native progress bars, have a look at
the <code>pbars</code> argument below.</p></dd>


<dt>pbars</dt>
<dd><p>An optional boolean indicating if progress bars should be displayed. Default is TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <a href="Xfgpm-class.html">Xfgpm</a> containing the data structures linked to the structural optimization
  of a funGp model. It includes as the main component an object of class <a href="fgpm-class.html">fgpm</a> corresponding to the
  optimized model. It is accessible through the <code>@model</code> slot of the Xfgpm object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Betancourt, J., Bachoc, F., Klein, T., Idier, D., Pedreros, R., and Rohmer, J. (2020),
"Gaussian process metamodeling of functional-input code for coastal flood hazard assessment".
<em>Reliability Engineering &amp; System Safety</em>, <strong>198</strong>, 106870.
<a href="https://doi.org/10.1016/j.ress.2020.106870" class="external-link">[RESS]</a>
<a href="https://hal.archives-ouvertes.fr/hal-01998724" class="external-link">[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., Klein, T., and Gamboa, F. (2020),
Technical Report: "Ant Colony Based Model Selection for Functional-Input Gaussian Process Regression. Ref. D3.b (WP3.2)".
<em>RISCOPE project</em>.
<a href="https://hal.archives-ouvertes.fr/hal-02532713" class="external-link">[HAL]</a></p>
<p>Betancourt, J., Bachoc, F., and Klein, T. (2020),
R Package Manual: "Gaussian Process Regression for Scalar and Functional Inputs with funGp - The in-depth tour".
<em>RISCOPE project</em>.
<a href="https://hal.archives-ouvertes.fr/hal-02536624" class="external-link">[HAL]</a></p>
<p>Dubrule, O. (1983),
"Cross validation of kriging in a unique neighborhood".
<em>Journal of the International Association for Mathematical Geology</em>, <strong>15</strong>,  687-699.
<a href="https://link.springer.com/article/10.1007/BF01033232" class="external-link">[MG]</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><strong>*</strong> <a href="plot-Xfgpm-method.html">plot,Xfgpm-method</a> with
    <code>which = "evolution"</code> for visualizing the evolution of
    the ACO algorithm, or with <code>which = "diag"</code> for a
    diagnostic plot;</p>
<p><strong>*</strong> <a href="get_active_in.html">get_active_in</a> for post-processing
    of input data structures following a fgpm_factory call;</p>
<p><strong>*</strong> <a href="predict-methods.html">predict,fgpm-method</a> for
    predictions based on a funGp model;</p>
<p><strong>*</strong> <a href="simulate-methods.html">simulate,fgpm-method</a> for
    simulations based on a funGp model;</p>
<p><strong>*</strong> <a href="update-methods.html">update,fgpm-method</a> for
    post-creation updates on a funGp model.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>José Betancourt, François Bachoc, Thierry Klein and Jérémy Rohmer</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#construction of a fgpm object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n.tr</span> <span class="op">&lt;-</span> <span class="fl">32</span></span>
<span class="r-in"><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x3</span> <span class="op">&lt;-</span> <span class="va">x4</span> <span class="op">&lt;-</span> <span class="va">x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, x3 <span class="op">=</span> <span class="va">x3</span>, x4 <span class="op">=</span> <span class="va">x4</span>, x5 <span class="op">=</span> <span class="va">x5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">            f2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span> <span class="op">*</span> <span class="fl">22</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="black-boxes.html">fgp_BB7</a></span><span class="op">(</span><span class="va">sIn</span>, <span class="va">fIn</span>, <span class="va">n.tr</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># optimizing the model structure with fgpm_factory (~12 seconds)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xm</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># assessing the quality of the model</span></span>
<span class="r-in"><span class="co"># in the absolute and also w.r.t. the other explored models</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xm</span>, which <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># checking the evolution of the algorithm</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xm</span>, which <span class="op">=</span> <span class="st">"evol"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Summary of the tested configurations</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">xm</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inputs and details </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    X1 X2 X3 X4 X5 F1 D_F1 Dim_F1 Bas_F1 F2 D_F2 Dim_F2 Bas_F2  Kern    Q2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      x  x  x  x  x  idx      1   Bspl  x  idx      3   Bspl gauss 0.939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      x  x  x  x  x  idx      1    PCA  x  idx      3   Bspl gauss 0.854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      x     x  x  x  idx      1   Bspl  x  idx      3   Bspl gauss 0.854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      x     x  x  x  grp      1   Bspl  x  idx      3   Bspl gauss 0.854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      x  x  x  x  x  idx      1   Bspl  x  idx      3   Bspl mat32 0.845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      x  x  x  x      --      -     --  x  idx      3   Bspl gauss 0.841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      x     x  x  x  idx      1   Bspl  x  idx      3   Bspl mat32 0.833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      x     x  x  x  idx      1   Bspl  x  idx      3   Bspl mat52 0.809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      x     x  x  x  idx      1   Bspl  x  grp     22    PCA gauss 0.788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     x     x  x  x  idx      1    PCA  x  idx      3   Bspl mat32 0.785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     x     x  x      --      -     --  x  idx      3   Bspl mat32 0.753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     x     x  x  x  idx      1   Bspl  x  idx      3    PCA gauss 0.721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     x  x  x  x  x  idx      1   Bspl  x  idx      1   Bspl gauss 0.678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     x  x  x         --      -     --  x  idx      3   Bspl gauss 0.623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     x     x  x  x  idx      1    PCA  x  idx      3    PCA gauss 0.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     x     x         --      -     --  x  idx      3    PCA gauss 0.589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           x  x  x  idx      1   Bspl  x  idx      3   Bspl mat32 0.570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     x  x  x  x  x  idx      1   Bspl  x  idx      3    PCA gauss 0.553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     x     x  x  x  grp      5   Bspl  x  idx      3    PCA mat32 0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     x  x            --      -     --  x  idx      3   Bspl mat32 0.477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     x     x         --      -     --  x  idx      3   Bspl mat52 0.469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     x  x     x  x  grp      2    PCA  x  idx      3   Bspl mat32 0.402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     x     x         --      -     --  x  idx      3    PCA mat32 0.379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  x     x  x  x      --      -     --  x  idx      3   Bspl mat32 0.098</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># checking the log of crashed iterations</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">xm</span><span class="op">@</span><span class="va">log.crashes</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "antsLog"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "sols":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data frame with 0 columns and 0 rows</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "args":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "fitness":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># building the model with the default fgpm arguments to compare</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n.tr</span> <span class="op">&lt;-</span> <span class="fl">32</span></span>
<span class="r-in"><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x3</span> <span class="op">&lt;-</span> <span class="va">x4</span> <span class="op">&lt;-</span> <span class="va">x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, x3 <span class="op">=</span> <span class="va">x3</span>, x4 <span class="op">=</span> <span class="va">x4</span>, x5 <span class="op">=</span> <span class="va">x5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in"><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span> <span class="op">*</span> <span class="fl">22</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="black-boxes.html">fgp_BB7</a></span><span class="op">(</span><span class="va">sIn</span>, <span class="va">fIn</span>, <span class="va">n.tr</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="fgpm.html">fgpm</a></span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Presampling...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Optimising hyperparameters...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 205.640552 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The function value is the negated log-likelihood</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ** Hyperparameters done!</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="co"># plotting the model</span></span>
<span class="r-plt img"><img src="fgpm_factory-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># improving performance with more iterations_______________________________________________</span></span>
<span class="r-in"><span class="co"># call to fgpm_factory (~22 seconds)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xm25</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span>,</span>
<span class="r-in">                     setup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># assessing evolution and quality</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xm25</span>, which <span class="op">=</span> <span class="st">"evol"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xm25</span>, which <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># custom solution space____________________________________________________________________</span></span>
<span class="r-in"><span class="va">myctr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>s_keepOn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co"># keep both scalar inputs always on</span></span>
<span class="r-in">f_keepOn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="co"># keep f2 always active</span></span>
<span class="r-in">f_disTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L2_byindex"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># only use L2_byindex distance for f2</span></span>
<span class="r-in">f_fixDims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co"># f2 projected in dimension 4</span></span>
<span class="r-in">f_maxDims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co"># f1 projected in dimension max 5</span></span>
<span class="r-in">f_basTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B-splines"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># only use B-splines projection for f1</span></span>
<span class="r-in">kerTypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matern5_2"</span>, <span class="st">"gauss"</span><span class="op">)</span><span class="op">)</span> <span class="co"># test only Matern 5/2 and Gaussian kernels</span></span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co"># call to fgpm_factory (~12 seconds)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xmc</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span>, ctraints <span class="op">=</span> <span class="va">myctr</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># assessing evolution and quality</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xmc</span>, which <span class="op">=</span> <span class="st">"evol"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xmc</span>, which <span class="op">=</span> <span class="st">"diag"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="fgpm_factory-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># verifying constraints with the log of some successfully built models</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">xmc</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inputs and details </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    X1 X2 X3 X4 X5 F1 D_F1 Dim_F1 Bas_F1 F2 D_F2 Dim_F2 Bas_F2  Kern     Q2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   x  x     x         --      -     --  x  idx      4   Bspl mat52  0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   x  x     x     x  idx      3   Bspl  x  idx      4   Bspl mat52  0.736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   x  x     x  x      --      -     --  x  idx      4   Bspl mat52  0.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   x  x     x  x  x  idx      3   Bspl  x  idx      4   Bspl mat52  0.471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   x  x  x  x         --      -     --  x  idx      4   Bspl mat52  0.430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   x  x        x      --      -     --  x  idx      4   Bspl gauss  0.430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   x  x               --      -     --  x  idx      4   Bspl mat52  0.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   x  x  x  x  x  x  idx      1   Bspl  x  idx      4   Bspl mat52  0.380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   x  x  x  x  x      --      -     --  x  idx      4   Bspl mat52  0.268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  x  x  x  x  x      --      -     --  x  idx      4    PCA gauss  0.260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  x  x  x  x  x      --      -     --  x  idx      4    PCA mat52  0.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  x  x  x     x      --      -     --  x  idx      4   Bspl mat52  0.101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  x  x        x  x  idx      1   Bspl  x  idx      4   Bspl gauss  0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  x  x        x  x  idx      2   Bspl  x  idx      4   Bspl mat52 -0.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  x  x     x         --      -     --  x  idx      4    PCA mat52 -0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  x  x     x         --      -     --  x  idx      4    PCA gauss -0.105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  x  x        x  x  idx      3   Bspl  x  idx      4   Bspl mat52 -0.158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  x  x  x     x  x  grp      3   Bspl  x  idx      4    PCA gauss -0.275</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># custom heuristic parameters______________________________________________________________</span></span>
<span class="r-in"><span class="va">mysup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">30</span>, n.pop <span class="op">=</span> <span class="fl">12</span>, tao0 <span class="op">=</span> <span class="fl">.15</span>, dop.s <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span class="r-in">              dop.f <span class="op">=</span> <span class="fl">1.3</span>, delta.f <span class="op">=</span> <span class="fl">4</span>, dispr.f <span class="op">=</span> <span class="fl">1.1</span>, q0 <span class="op">=</span> <span class="fl">.85</span>,</span>
<span class="r-in">              rho.l <span class="op">=</span> <span class="fl">.2</span>, u.gbest <span class="op">=</span> <span class="cn">TRUE</span>, n.ibest <span class="op">=</span> <span class="fl">2</span>, rho.g <span class="op">=</span> <span class="fl">.08</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># call to fgpm_factory (~20 seconds)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xmh</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span>, setup <span class="op">=</span> <span class="va">mysup</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># verifying heuristic setup through the details of the Xfgpm object</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">xmh</span><span class="op">@</span><span class="va">details</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.iter    n.pop     tao0    dop.s    dop.f delta.f1 delta.f2 dispr.f1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    30.00    12.00     0.15     1.20     1.30     4.00     4.00     1.10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dispr.f2       q0    rho.l  u.gbest  n.ibest    rho.g </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.10     0.85     0.20     1.00     2.00     0.08 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># stopping condition based on time_________________________________________________________</span></span>
<span class="r-in"><span class="va">mysup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.iter <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mytlim</span> <span class="op">&lt;-</span> <span class="fl">60</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># call to fgpm_factory (~60 seconds)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">xms</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span>,</span>
<span class="r-in">                    setup <span class="op">=</span> <span class="va">mysup</span>, time.lim <span class="op">=</span> <span class="va">mytlim</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">xms</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inputs and details </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    X1 X2 X3 X4 X5 F1 D_F1 Dim_F1 Bas_F1 F2 D_F2 Dim_F2 Bas_F2  Kern    Q2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      x     x     x  idx      2   Bspl  x  idx      2   Bspl gauss 0.979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      x     x     x  grp      2   Bspl  x  idx      2   Bspl gauss 0.978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      x     x     x  idx      2   Bspl  x  idx      2   Bspl mat52 0.977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      x     x  x  x  idx      2   Bspl  x  idx      2   Bspl gauss 0.976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      x  x  x     x  idx      2   Bspl  x  idx      2   Bspl gauss 0.973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   x        x  x  x  idx      2   Bspl  x  idx      2   Bspl gauss 0.972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            x  x  x  idx      2   Bspl  x  idx      2   Bspl gauss 0.972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            x  x  x  idx      3   Bspl  x  idx      2   Bspl gauss 0.968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         x  x  x  x  idx      2   Bspl  x  idx      2   Bspl gauss 0.964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           x  x  x  idx      2   Bspl  x  idx      3   Bspl gauss 0.964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     x     x  x  x  idx      2   Bspl  x  idx      3   Bspl gauss 0.963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           x     x  idx      2   Bspl  x  idx      2   Bspl gauss 0.963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     x     x  x  x  idx      2   Bspl  x  grp      6   Bspl gauss 0.961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     x     x     x  grp      3   Bspl  x  idx      2   Bspl gauss 0.959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     x     x  x  x  grp      2   Bspl  x  idx      2   Bspl gauss 0.959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           x  x  x  idx      2   Bspl  x  idx      2   Bspl mat32 0.958</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     x     x  x  x  idx      2   Bspl  x  idx      2   Bspl mat52 0.956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18        x  x  x  x  idx      2   Bspl  x  idx      3   Bspl gauss 0.953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     x     x     x  idx      2   Bspl  x  idx      2   Bspl mat32 0.953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     x     x  x  x  grp      3   Bspl  x  idx      2   Bspl gauss 0.948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  x  x     x  x  x  idx      2   Bspl  x  idx      2   Bspl gauss 0.946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22           x  x  x  idx      2   Bspl  x  idx      3   Bspl mat52 0.944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     x     x  x  x  idx      2   Bspl  x  idx      3   Bspl mat52 0.943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     x     x  x  x  idx      2   Bspl  x  grp      7   Bspl gauss 0.942</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># parallelization in the model factory_____________________________________________________</span></span>
<span class="r-in"><span class="co"># generating input and output data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n.tr</span> <span class="op">&lt;-</span> <span class="fl">243</span></span>
<span class="r-in"><span class="va">sIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                   x3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>, x4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                   x5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length <span class="op">=</span> <span class="va">n.tr</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, f2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n.tr</span><span class="op">*</span><span class="fl">22</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="black-boxes.html">fgp_BB7</a></span><span class="op">(</span><span class="va">sIn</span>, <span class="va">fIn</span>, <span class="va">n.tr</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># calling fgpm_factory in parallel</span></span>
<span class="r-in"><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">xm.par</span> <span class="op">&lt;-</span> <span class="fu">fgpm_factory</span><span class="op">(</span>sIn <span class="op">=</span> <span class="va">sIn</span>, fIn <span class="op">=</span> <span class="va">fIn</span>, sOut <span class="op">=</span> <span class="va">sOut</span>, par.clust <span class="op">=</span> <span class="va">cl</span><span class="op">)</span> <span class="co">#  (~260 seconds)</span></span>
<span class="r-in"><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># NOTE: in order to provide progress bars for the monitoring of time consuming processes</span></span>
<span class="r-in"><span class="co">#       ran in parallel, funGp relies on the doFuture and future packages. Parallel processes</span></span>
<span class="r-in"><span class="co">#       suddenly interrupted by the user tend to leave corrupt connections. This problem is</span></span>
<span class="r-in"><span class="co">#       originated outside funGp, which limits our control over it. In the manual</span></span>
<span class="r-in"><span class="co">#       of funGp, we provide a temporary solution to the issue and we remain attentive in</span></span>
<span class="r-in"><span class="co">#       case it appears a more elegant way to handle it or a manner to suppress it.</span></span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co">#       funGp manual: https://hal.archives-ouvertes.fr/hal-02536624</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jose Betancourt, François Bachoc, Thierry Klein, Jeremy Rohmer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

